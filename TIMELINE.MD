# Хранилище данных Timeline

## Описание
Преставляет из себя виртуальное хранилище данных, которое по запросу может выдать параметры времени, полученные от 
переданного в запрос id.

Id элемента в этом хранилище является метка времени с десятыми долями секунды. Если попытаться запросить элемент, 
модуль id которого выходит за рамки PHP_INT_MAX, сгенерируется исключение. Если запросить элемент, у которого id
содержит сотые и/или меньшие доли секунды, то объект вернет null, что будет означать, что элемент не существует.

Хранилище называется виртуальным, потому что на самом деле оно ничего не хранит. Когда производится попытка считать
элемент хранилища, на самом деле просто берется переданный id, и от него строятся элементы даты 
(функция [getdate](http://www.php.su/getdate)).

Из операций CRUD этот тип хранилища позволяет работу только с "R" - данные можно только считать. Все остальные операции
запрещены. При попытке их использования будет сгенерировано исключение.

Если попытаться считать данные без указания ограничения по промежутку времени, то будет сгенерировано исключение о 
достижении максимально допустимого числа элементов.

## Технические характеристики
Класс хранилища является наследником класса [\zaboy\rest\DataStore\DataStoreAbstract]
(https://github.com/avz-cmf/zaboy-rest/blob/master/src/DataStore/DataStoreAbstract.php).

Пределы возможностей хранилища - допустимый диапазон Unix-времени, т.е. от - PHP_INT_MAX до
+PHP_INT_MAX (примерно с 14 декбаря 1901 года до 19 января 2038).

Один из способов получить данные - использовать метод read, передав в него нужный id. Если id будет корректной меткой времени с десятыми долями
секунды или без них, то элемент будет гарантировано существовать.

Другой способ - использовать метод query, передав в него объект [RQL-запроса](https://github.com/xiag-ag/rql-parser). В этом
запросе обязательно должны быть ограничения по времени, иначе будет сгенерировано исключение, как только будет достигнут
допустимый предел  в 100000 (сто тысяч) элементов.


## TimelineIterator
Хранилище Timeline, так же, как и его родитель, является Iterable и использует специальный итератор TimelineIterator.
Сам по себе этот итератор является независимым классом, и его можно использовать для других целей.
 
Итератор принимает следующие параметры:

 - **callback**; это переменная типа callable, в которую итератор перенаправит запрос при попытке считать текущее значение
 (метод current). В случае взаимодействия с Timeline callback'ом выступает метод Timeline::read. Так было сделано, чтобы
 отвязать итератор от Timeline, и его можно было использовать в других целях.
 
 - **from**; начало итераций.
 
 - **number**; кол-во итераций
 
 - **step**; шаг итераций. Значение должно быть большим нуля.
  
 Метод valid() итератора проверяет, чтобы текущий индекс входил в диапазон Int и при этом не было превышено допустимое
 кол-во элементов/итераций (сто тысяч).